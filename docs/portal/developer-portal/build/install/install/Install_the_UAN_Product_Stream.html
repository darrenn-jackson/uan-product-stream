<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2022"><meta name="generator" content="DITA-OT"><title>Install the UAN Product Stream</title><link rel="stylesheet" type="text/css" href="../css/commonltr.css"><link rel="stylesheet" type="text/css" href="../css/css_parent.css"></head><body id="install-the-uan-product-stream"><main role="main"><article role="article" aria-labelledby="ariaid-title1"><h1 class="title topictitle1" id="ariaid-title1">Install the UAN Product Stream</h1><div class="body"><p class="p">This procedure installs the User Access Nodes (UAN) product on a system so that UAN boot images can be created.</p><p class="p">Before performing this procedure:</p><ul class="ul"><li class="li"><p class="p">Initialize and configure the Cray command line interface (CLI) tool. See "Configure the Cray Command Line Interface (CLI)" in the CSM documentation for more information.</p></li><li class="li"><p class="p">Perform <a class="xref" href="../installation_prereqs/Prepare_for_UAN_Product_Installation.html">Prepare for UAN Product Installation</a></p></li></ul><p class="p">Replace <code class="ph codeph">PRODUCT_VERSION</code> in the example commands with the UAN product stream string (2.3.0 for example). Replace <code class="ph codeph">CRAY_EX_DOMAIN</code> in the example commands with the FQDN of the HPE Cray EX.</p><ol class="ol"><li class="li"><p class="p">Start a typescript to capture the commands and output from this installation.</p><pre class="pre codeblock bash"><code>ncn-m001# script -af product-uan.$(date +%Y-%m-%d).txt 
ncn-m001# export PS1='\u@\H \D{%Y-%m-%d} \t \w # '</code></pre></li><li class="li"><p class="p">Run the installation script:</p><pre class="pre codeblock bash"><code>ncn-m001# ./install.sh</code></pre></li><li class="li"><p class="p">Verify that the UAN configuration was imported and added to the <code class="ph codeph">cray-product-catalog</code> ConfigMap in the Kubernetes <code class="ph codeph">services</code> namespace.</p><ol class="ol" type="a"><li class="li"><p class="p">Run the following command and verify that the output contains an entry for the <code class="ph codeph">PRODUCT_VERSION</code> that was installed in the previous steps:</p><pre class="pre codeblock bash"><code>ncn-m001# kubectl get cm cray-product-catalog -n services -o json | jq -r .data.uan
PRODUCT_VERSION:
     configuration:
       clone_url: https://vcs.CRAY_EX_DOMAIN/vcs/cray/uan-config-management.git
       commit: 6658ea9e75f5f0f73f78941202664e9631a63726
       import_branch: cray/uan/PRODUCT_VERSION
       import_date: 2021-07-28 03:26:00.399670
       ssh_url: git@vcs.CRAY_EX_DOMAIN:cray/uan-config-management.git</code></pre></li><li class="li"><p class="p">Verify that the Kubernetes jobs that import the configuration content completed successfully. Skip this step if the previous substep indicates that the new UAN product version content installed successfully.</p><p class="p">A STATUS of <code class="ph codeph">Completed</code> indicates that the Kubernetes jobs completed successfully.</p><pre class="pre codeblock bash"><code>ncn-m001# kubectl get pods -n services | grep uan
uan-config-import-PRODUCT_VERSION-wfh4f                                  0/3     Completed   0          3m15s</code></pre></li></ol></li><li class="li"><p class="p">Verify that the UAN RPM repositories have been created in Nexus:</p><p class="p"><code class="ph codeph">PRODUCT_VERSION</code> is the UAN release number and <code class="ph codeph">SLE_VERSION</code> is the SLE release version, such as <code class="ph codeph">15sp2</code> or <code class="ph codeph">15sp3</code>.</p><p class="p">Query Nexus through its REST API to display the repositories prefixed with the name uan:</p><pre class="pre codeblock bash"><code>ncn-m001# curl -s -k https://packages.local/service/rest/v1/repositories | jq -r '.[] | select(.name | startswith("uan")) | .name'
uan-PRODUCT_VERSION-sle-SLE_VERSION</code></pre></li><li class="li"><p class="p">Finish the typescript file started at the beginning of this procedure.</p><pre class="pre codeblock bash"><code># exit</code></pre></li><li class="li"><p class="p"><strong class="ph b">Optional:</strong> Perform <a class="xref" href="../upgrade/Merge_UAN_Configuration_Data.html#merge-uan-configuration-data">Merge UAN Configuration Data</a> if a previous version of the UAN product was already installed.</p></li></ol></div></article></main></body></html>